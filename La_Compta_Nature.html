<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Les comptes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #000000;
        }
        
        /* Style du titre */
        .title-container {
            background-color: #78004f; /* Violet */
            color: white;
            padding: 15px;
            text-align: center;
			border-radius: 12px;
            border-top: 5px solid #ffa500; /* Orange */
            border-bottom: 5px solid #24FF7C; /* Bleu clair */
            margin-bottom: 20px;
        }
        
        h1 {
            margin: 0;
        }
        
        /* Style des sélections */
        .selection-container {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
			 border-bottom: 5px solid #24FFF0; /* Bleu clair */
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .option-group {
            flex: 1;
            min-width: 200px;
        }
        
        .comment {
            font-style: italic;
            color: #555;
            margin-top: 5px;
            min-height: 20px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        button:hover {
            background-color: #317532;
        }
        
        /* Style du tableau des comptes */
        .exercise-container {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #8eddf8;
        }
        
        input[type="radio"] {
            transform: scale(1.2);
        }
        
        .correct {
            background-color: #d4edda !important; /* Vert clair pour les bonnes réponses */
        }
        
        .incorrect {
            background-color: #f8d7da !important; /* Rouge clair pour les mauvaises réponses */
        }
        
        .correct-answer {
            font-weight: bold;
            color: #28a745;
        }
        
        /* Style des messages de résultat */
        .results-container {
            display: none;
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .score-display {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: #66e867;
            border: 2px solid #dee2e6;
        }
        
        .score-message {
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            border-radius: 4px;
            background-color: #f8f9fa;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            font-style: italic;
            color: #fbb5ec;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .return-message {
            align-self: center;
            font-style: italic;
            color: #555;
            display: none;
        }
        
        .quit-button {
            background-color: #ff4747;
			transition: background-color 0.3s, transform 0.1s;
			box-shadow: 4px 4px 6px rgba(0,0,0,0.5);			
        }
        
        .quit-button:hover {
            background-color: #ff0000;
			transform: translateY(-4px);
			box-shadow: 6px 6px 8px rgba(0,0,0,0.5);			
        }
        .start-button {
            background-color: #4CAF50; /* Vert */
			color: white;
			transition: background-color 0.3s, transform 0.1s;
			box-shadow: 4px 4px 6px rgba(0,0,0,0.5);	
        }
        
        .start-button:hover {
            background-color: #077d00;
			transform: translateY(-4px);
			box-shadow: 6px 6px 8px rgba(0,0,0,0.5);
			transform: translateY(-4px);
        }		

		.btn-menu {
			background-color: #BD99AC; 
			color: white;
			box-shadow: 4px 4px 6px rgba(0,0,0,0.5);	
			transition: background-color 0.3s, transform 0.1s;
		}

		.btn-menu:hover {
			background-color: #700158;
			box-shadow: 6px 6px 8px rgba(0,0,0,0.5);
			transform: translateY(-4px);
			}

		.btn-valider {
			background-color: #61b865;
			color: white;
			box-shadow: 4px 4px 6px rgba(0,0,0,0.5);	
			transition: background-color 0.3s, transform 0.1s;			
		}

		.btn-valider:hover {
			background-color: #00b50d;
			transition: background-color 0.3s, transform 0.1s;
			box-shadow: 6px 6px 8px rgba(0,0,0,0.5);
			transform: translateY(-4px);
		}

		.btn-nouveau {
			background-color: #ffbf47;
			color: white;
			box-shadow: 4px 4px 6px rgba(0,0,0,0.5);	
			transition: background-color 0.3s, transform 0.1s;			
		}

		.btn-nouveau:hover {
			background-color: #ffa500;
			transition: background-color 0.3s, transform 0.1s;
			box-shadow: 6px 6px 8px rgba(0,0,0,0.5);
			transform: translateY(-4px);
		}

    </style>
</head>
<body>
    <div class="title-container">
        <h1>Les comptes</h1>
        <h2>Quelle est la nature des comptes ? Actif, passif, charge ou produit ?</h2>
    </div>
    
    <div class="selection-container" id="selectionContainer">
        <div class="options">
            <div class="option-group">
                <h3>Niveau :</h3>
                <label><input type="checkbox" id="debutant" value="D" checked> Débutant (1ère année)</label><br>
                <label><input type="checkbox" id="avance" value="A"> Avancé (2-3è année)</label>
            </div>
            
            <div class="option-group">
                <h3>Nombre de comptes :</h3>
                <select id="countSelect">
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="all">Tous</option>
                </select>
                <div id="countComment" class="comment">10=c'est bien de commencer petit.</div>
            </div>
            
            <div class="option-group">
                <h3>Mode de jeu :</h3>
                <label><input type="radio" name="mode" value="apprentissage" checked> Apprentissage</label><br>
                <label><input type="radio" name="mode" value="defit"> Défit</label>
            </div>
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: center;">
			<button id="startButton" class="start-button">Lancer</button>
			<button id="quitButton" class="quit-button">Quitter</button>
        </div>
        
        <div id="rules">
            <h4>Mode de jeu :</h4>
            <p>Apprentissage : pas de score. Si la réponse est correcte, fond vert. Réponse fausse : fond rouge</p>
			<p>Défit : Tu connaîtras ton score à la fin, avec indication des erreurs et une correction</p>
        </div>
    </div>
    
    <div class="exercise-container" id="exerciseContainer">
        
        <table id="accountsTable">
            <thead>
                <tr>
                    <th>Compte</th>
                    <th>ACTIF</th>
                    <th>PASSIF</th>
                    <th>CHARGE</th>
                    <th>PRODUIT</th>
                </tr>
            </thead>
            <tbody id="accountsBody">
                <!-- Les comptes seront générés ici -->
            </tbody>
        </table>
        
        <div class="navigation">
				<button id="validateButton" class="btn-valider" style="display: none;">Valider</button>
				<button id="newExerciseButton" class="btn-nouveau">Nouvel exercice</button>
				<button id="backToMenuButton" class="btn-menu">Retour au menu</button>
        </div>
    </div>
    
    <div class="results-container" id="resultsContainer">
        <div id="scoreDisplay" class="score-display"></div>
        <div id="scoreMessage" class="score-message"></div>
        
        <h3>Correction des réponses :</h3>
        <table id="correctionTable">
            <thead>
                <tr>
                    <th>Compte</th>
                    <th>Votre réponse</th>
                    <th>Réponse correcte</th>
                </tr>
            </thead>
            <tbody id="correctionBody">
                <!-- Les corrections seront générées ici -->
            </tbody>
        </table>
        
        <div class="navigation">
				<button id="restartButton" class="btn-nouveau">Nouvel exercice</button>
				<button id="backToMenuFromResultsButton" class="btn-menu">Retour au menu</button>
        </div>
    </div>
    
    <div class="footer">
        <p>"Je fais de la compta et c'est ma joie", DG, EPC Fribourg</p>
    </div>

    <script>
        // Liste des comptes avec niveau et nature
        const accounts = [
            { niveau: "D", nom: "Caisse", nature: "Actif" },
            { niveau: "D", nom: "Banque (avoir)", nature: "Actif" },
            { niveau: "D", nom: "Banque (dette)", nature: "Passif" },
            { niveau: "D", nom: "Poste", nature: "Actif" },
            { niveau: "D", nom: "Créances clients", nature: "Actif" },
            { niveau: "D", nom: "Stock de marchandises", nature: "Actif" },
            { niveau: "A", nom: "Créances douteuses", nature: "Actif" },
            { niveau: "A", nom: "Titres", nature: "Actif" },
            { niveau: "A", nom: "Actifs transitoires", nature: "Actif" },
            { niveau: "D", nom: "Mobilier et installation", nature: "Actif" },
            { niveau: "D", nom: "Véhicules", nature: "Actif" },
            { niveau: "D", nom: "Machines", nature: "Actif" },
            { niveau: "A", nom: "FAC sur machines", nature: "Passif" },
            { niveau: "A", nom: "FAC sur véhicules", nature: "Passif" },
            { niveau: "A", nom: "Brevet", nature: "Actif" },
            { niveau: "D", nom: "Dettes fournisseurs", nature: "Passif" },
            { niveau: "D", nom: "Autres dettes", nature: "Passif" },
            { niveau: "D", nom: "Capital", nature: "Passif" },
            { niveau: "D", nom: "Privé", nature: "Passif" },
            { niveau: "A", nom: "Ducroire", nature: "Passif" },
            { niveau: "D", nom: "Salaire", nature: "Charge" },
            { niveau: "D", nom: "Loyer", nature: "Charge" },
            { niveau: "D", nom: "Amortissements", nature: "Charge" },
            { niveau: "D", nom: "Charges financières", nature: "Charge" },
            { niveau: "D", nom: "Produits financiers", nature: "Produit" },
            { niveau: "A", nom: "Pertes sur créances", nature: "Charge" },
            { niveau: "D", nom: "Achat de marchandises", nature: "Charge" },
            { niveau: "D", nom: "Déductions accordées", nature: "Charge" },
            { niveau: "D", nom: "Vente de marchandises", nature: "Produit" },
            { niveau: "D", nom: "Déductions obtenues", nature: "Produit" },
            { niveau: "A", nom: "Prestations propres", nature: "Produit" },
            { niveau: "D", nom: "ACE", nature: "Charge" },
            { niveau: "D", nom: "Entretien et réparation", nature: "Charge" },
            { niveau: "A", nom: "Charges exceptionnelles", nature: "Charge" },
            { niveau: "A", nom: "Produits exceptionnels", nature: "Produit" },
            { niveau: "D", nom: "Frais de véhicule", nature: "Charge" }
        ];

        // Éléments DOM
        const countSelect = document.getElementById('countSelect');
        const countComment = document.getElementById('countComment');
        const startButton = document.getElementById('startButton');
        const quitButton = document.getElementById('quitButton');
        const selectionContainer = document.getElementById('selectionContainer');
        const exerciseContainer = document.getElementById('exerciseContainer');
        const accountsBody = document.getElementById('accountsBody');
        const validateButton = document.getElementById('validateButton');
        const newExerciseButton = document.getElementById('newExerciseButton');
        const backToMenuButton = document.getElementById('backToMenuButton');
        const backToMenuFromResultsButton = document.getElementById('backToMenuFromResultsButton');
        const resultsContainer = document.getElementById('resultsContainer');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const scoreMessage = document.getElementById('scoreMessage');
        const restartButton = document.getElementById('restartButton');
        const returnMessage = document.getElementById('returnMessage');
        const resultsReturnMessage = document.getElementById('resultsReturnMessage');
        const correctionBody = document.getElementById('correctionBody');

        // Commentaires pour le nombre de comptes
        const countComments = {
            '10': 'C\'est bien de commencer petit.',
            '15': 'Pas plus ?',
            '20': 'Waouh! Bel effort.',
            'all': 'Aaah! La compta, c\'est ta joie, tché!'
        };

        // Messages d'encouragement selon le score
        const encouragementMessages = {
            low: "Encore un effort et tu y seras.",
            medium: "Pas mal, mais un peu plus serait encore mieux.",
            good: "Bravo, si c'est ton premier essai. Sinon, ne veux-tu pas tenter de t'améliorer encore ?",
            excellent: "Manque peu et c'est le graal!",
            perfect: "On tient notre comptable. Refais cet exercice de temps en temps pour maintenir le niveau."
        };

        // Variables pour suivre l'état de l'exercice
        let selectedAccounts = [];
        let isLearningMode = true;
        let answers = {};

        // Événement lors du changement du nombre de comptes
        countSelect.addEventListener('change', () => {
            countComment.textContent = countComments[countSelect.value];
        });

        // Initialisation des commentaires
        countComment.textContent = countComments[countSelect.value];

        // Bouton quitter
        quitButton.addEventListener('click', () => {
            window.close();
        });

        // Démarrer l'exercice
        startButton.addEventListener('click', () => {
            const debutantChecked = document.getElementById('debutant').checked;
            const avanceChecked = document.getElementById('avance').checked;
            const countValue = countSelect.value;
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            isLearningMode = mode === 'apprentissage';
            
            // Filtrer les comptes selon le niveau sélectionné
            let filteredAccounts = accounts;
            if (debutantChecked && !avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'D');
            } else if (!debutantChecked && avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'A');
            }
            
            // Sélectionner le nombre de comptes demandé
            if (countValue === 'all') {
                selectedAccounts = [...filteredAccounts];
            } else {
                const count = parseInt(countValue);
                // Mélanger les comptes et en prendre le nombre demandé
                selectedAccounts = shuffleArray([...filteredAccounts]).slice(0, count);
            }
            
            // Initialiser les réponses
            answers = {};
            
            // Afficher l'exercice
            displayAccounts();
            selectionContainer.style.display = 'none';
            exerciseContainer.style.display = 'block';
            
            // Afficher le bouton Valider seulement en mode défit
            validateButton.style.display = isLearningMode ? 'none' : 'block';
        });

        // Bouton retour au menu (page exercice)
        backToMenuButton.addEventListener('click', () => {
            exerciseContainer.style.display = 'none';
            resultsContainer.style.display = 'none';
            selectionContainer.style.display = 'block';
        });

        // Bouton retour au menu (page résultats)
        backToMenuFromResultsButton.addEventListener('click', () => {
            resultsContainer.style.display = 'none';
            selectionContainer.style.display = 'block';
        });

        // Nouvel exercice (reste sur la même page)
        newExerciseButton.addEventListener('click', () => {
            const debutantChecked = document.getElementById('debutant').checked;
            const avanceChecked = document.getElementById('avance').checked;
            const countValue = countSelect.value;
            
            // Filtrer les comptes selon le niveau sélectionné
            let filteredAccounts = accounts;
            if (debutantChecked && !avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'D');
            } else if (!debutantChecked && avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'A');
            }
            
            // Sélectionner le nombre de comptes demandé
            if (countValue === 'all') {
                selectedAccounts = [...filteredAccounts];
            } else {
                const count = parseInt(countValue);
                // Mélanger les comptes et en prendre le nombre demandé
                selectedAccounts = shuffleArray([...filteredAccounts]).slice(0, count);
            }
            
            // Réinitialiser les réponses
            answers = {};
            
            // Afficher les nouveaux comptes
            displayAccounts();
        });

        // Redémarrer l'exercice (depuis la page de résultats)
        restartButton.addEventListener('click', () => {
            const debutantChecked = document.getElementById('debutant').checked;
            const avanceChecked = document.getElementById('avance').checked;
            const countValue = countSelect.value;
            
            // Filtrer les comptes selon le niveau sélectionné
            let filteredAccounts = accounts;
            if (debutantChecked && !avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'D');
            } else if (!debutantChecked && avanceChecked) {
                filteredAccounts = accounts.filter(account => account.niveau === 'A');
            }
            
            // Sélectionner le nombre de comptes demandé
            if (countValue === 'all') {
                selectedAccounts = [...filteredAccounts];
            } else {
                const count = parseInt(countValue);
                // Mélanger les comptes et en prendre le nombre demandé
                selectedAccounts = shuffleArray([...filteredAccounts]).slice(0, count);
            }
            
            // Réinitialiser les réponses
            answers = {};
            
            // Afficher les nouveaux comptes
            displayAccounts();
            
            // Retourner à la page d'exercice
            resultsContainer.style.display = 'none';
            exerciseContainer.style.display = 'block';
        });

        // Valider les réponses (mode défit)
        validateButton.addEventListener('click', () => {
            validateAnswers();
        });

        // Afficher les comptes dans le tableau
        function displayAccounts() {
            accountsBody.innerHTML = '';
            
            selectedAccounts.forEach((account, index) => {
                const row = document.createElement('tr');
                row.id = `account-${index}`;
                
                const nameCell = document.createElement('td');
                nameCell.textContent = account.nom;
                row.appendChild(nameCell);
                
                // Créer les cases à cocher pour chaque nature
                const natures = ['Actif', 'Passif', 'Charge', 'Produit'];
                natures.forEach(nature => {
                    const cell = document.createElement('td');
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `account-${index}`;
                    radio.value = nature;
                    
                    radio.addEventListener('change', () => {
                        answers[index] = nature;
                        
                        if (isLearningMode) {
                            // En mode apprentissage, vérifier immédiatement la réponse
                            if (nature === account.nature) {
                                row.classList.add('correct');
                                row.classList.remove('incorrect');
                            } else {
                                row.classList.add('incorrect');
                                row.classList.remove('correct');
                            }
                        }
                    });
                    
                    cell.appendChild(radio);
                    row.appendChild(cell);
                });
                
                accountsBody.appendChild(row);
            });
        }

        // Valider toutes les réponses (mode défit)
        function validateAnswers() {
            let correctCount = 0;
            
            // Préparer la correction
            correctionBody.innerHTML = '';
            
            selectedAccounts.forEach((account, index) => {
                const row = document.getElementById(`account-${index}`);
                const userAnswer = answers[index];
                const isCorrect = userAnswer === account.nature;
                
                if (isCorrect) {
                    row.classList.add('correct');
                    correctCount++;
                } else {
                    row.classList.add('incorrect');
                    
                    // Ajouter une coche verte pour la bonne réponse
                    const correctRadio = row.querySelector(`input[value="${account.nature}"]`);
                    if (correctRadio) {
                        correctRadio.checked = true;
                        correctRadio.parentElement.style.backgroundColor = '#d4edda';
                    }
                }
                
                // Ajouter la ligne de correction
                const correctionRow = document.createElement('tr');
                
                const accountCell = document.createElement('td');
                accountCell.textContent = account.nom;
                correctionRow.appendChild(accountCell);
                
                const userAnswerCell = document.createElement('td');
                userAnswerCell.textContent = userAnswer || 'Non répondu';
                if (!userAnswer) {
                    userAnswerCell.style.color = '#6c757d';
                    userAnswerCell.style.fontStyle = 'italic';
                } else if (!isCorrect) {
                    userAnswerCell.style.color = '#dc3545';
                    userAnswerCell.style.fontWeight = 'bold';
                }
                correctionRow.appendChild(userAnswerCell);
                
                const correctAnswerCell = document.createElement('td');
                correctAnswerCell.textContent = account.nature;
                correctAnswerCell.classList.add('correct-answer');
                correctionRow.appendChild(correctAnswerCell);
                
                if (!isCorrect && userAnswer) {
                    correctionRow.style.backgroundColor = '#f8d7da';
                }
                
                correctionBody.appendChild(correctionRow);
            });
            
            // Calculer le score
            const score = Math.round((correctCount / selectedAccounts.length) * 100);
            
            // Afficher le score
            scoreDisplay.innerHTML = `Ton score: ${score}%`;
            
            // Afficher le message d'encouragement approprié
            if (score < 60) {
                scoreMessage.innerHTML = encouragementMessages.low;
            } else if (score >= 60 && score <= 75) {
                scoreMessage.innerHTML = encouragementMessages.medium;
            } else if (score >= 76 && score <= 90) {
                scoreMessage.innerHTML = encouragementMessages.good;
            } else if (score >= 91 && score < 100) {
                scoreMessage.innerHTML = encouragementMessages.excellent;
            } else {
                scoreMessage.innerHTML = encouragementMessages.perfect;
            }
            
            // Afficher le conteneur de résultats
            exerciseContainer.style.display = 'none';
            resultsContainer.style.display = 'block';
        }

        // Mélanger un tableau (algorithme de Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
</body>
</html>